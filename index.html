<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸš› Ù…ØºØ§Ù…Ø±Ø© Ø³Ù„Ø§Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¡ â€“ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ù‚Ù„</title>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/qrious@4.0.2/dist/qrious.min.js"></script>
  <style>
    :root {
      --primary: #2E7D32; /* green */
      --primary-600: #1B5E20;
      --secondary: #2F3A3B; /* dark slate */
      --accent: #AF9961; /* muted gold */
      --muted: #ECEFF1; /* light gray */
      --ink: #253033;
      --ink-soft: #4a5b60;
      --paper: #ffffff;
      --success-bg: #E8F5E9; /* subtle green */
      --danger-bg: #FDECEA; /* subtle red */
      --success-border: #A5D6A7;
      --danger-border: #FFCDD2;
    }

    html, body { height: 100%; }
    html { font-size: 140%; }
    body {
      font-family: 'Amiri', 'Cairo', 'Scheherazade New', serif;
      margin: 0;
      padding-bottom: 90px;
      color: var(--ink);
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
    }

    header {
      background: linear-gradient(90deg, var(--secondary), var(--primary));
      color: white;
      padding: 0.75rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    }
    header img { height: 56px; }
    header h1 {
      flex-grow: 1;
      text-align: center;
      margin: 0;
      font-family: 'Amiri', serif;
      font-size: 50px;
      letter-spacing: .5px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    

    .container {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1.5rem;
      background: var(--paper);
      border-radius: 20px;
      box-shadow:
        0 8px 32px rgba(0,0,0,0.12),
        0 2px 8px rgba(0,0,0,0.08);
      border: 2px solid #E0E6EA;
      position: relative;
      overflow: hidden;
    }
    
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #2E7D32, #43A047, #66BB6A, #81C784);
    }

    /* Per-category theme ring for the whole question box */
    #quizBox.qtheme-cool { box-shadow: 0 0 0 6px #1e88e533 inset, 0 1px 0 #00000008, 0 6px 14px rgba(0,0,0,0.10), 0 18px 40px rgba(0,0,0,0.08); }
    #quizBox.qtheme-clean { box-shadow: 0 0 0 6px #00acc133 inset, 0 1px 0 #00000008, 0 6px 14px rgba(0,0,0,0.10), 0 18px 40px rgba(0,0,0,0.08); }
    #quizBox.qtheme-transport { box-shadow: 0 0 0 6px #43A04733 inset, 0 1px 0 #00000008, 0 6px 14px rgba(0,0,0,0.10), 0 18px 40px rgba(0,0,0,0.08); }
    #quizBox.qtheme-pack { box-shadow: 0 0 0 6px #8D6E6333 inset, 0 1px 0 #00000008, 0 6px 14px rgba(0,0,0,0.10), 0 18px 40px rgba(0,0,0,0.08); }
    #quizBox.qtheme-label { box-shadow: 0 0 0 6px #F57C0033 inset, 0 1px 0 #00000008, 0 6px 14px rgba(0,0,0,0.10), 0 18px 40px rgba(0,0,0,0.08); }

    /* Remove gradients: keep a clean solid surface */
    #quizBox.qtheme-cool,
    #quizBox.qtheme-clean,
    #quizBox.qtheme-transport,
    #quizBox.qtheme-pack,
    #quizBox.qtheme-label { background-image: none; background: var(--paper); }

    .question {
      font-family: 'Amiri', serif;
      font-size: 38px;
      color: #1e1e1e;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 12px;
      line-height: 1.4;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .question::before { content: ''; }
    .qicon { display:none; }
    .qicon.cool { color: #1e88e5; }
    .qicon.clean { color: #00acc1; }
    .qicon.transport { color: #43A047; }
    .qicon.pack { color: #8D6E63; }
    .qicon.label { color: #F57C00; }

    .qbadge {
      display: inline-block;
      margin-right: 8px;
      padding: 4px 10px;
      border-radius: 999px;
      font-family: 'Cairo', sans-serif;
      font-weight: 600;
      font-size: 0.65em;
      vertical-align: middle;
      border: 2px solid #00000012;
      background: #fff;
    }
    .qbadge.cool { background: #bbdefb; color: #0d47a1; }
    .qbadge.clean { background: #b2ebf2; color: #006064; }
    .qbadge.transport { background: #c8e6c9; color: #1b5e20; }
    .qbadge.pack { background: #e1bee7; color: #4a148c; }
    .qbadge.label { background: #ffe0b2; color: #e65100; }

    .options { list-style: none; padding: 0; margin: 0; }
    .options li {
      position: relative;
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      margin: 0.8rem 0;
      padding: 1.2rem 1.4rem;
      border-radius: 16px;
      cursor: pointer;
      font-size: 1.1em;
      font-family: 'Cairo', sans-serif;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.04);
      border: 2px solid #E0E6EA;
      transform: translateY(0);
    }
    
    .options li::before {
      content: 'ğŸ“‹';
      margin-left: 8px;
      font-size: 1.2em;
    }
    .options li:hover { 
      transform: translateY(-3px) scale(1.02); 
      box-shadow: 0 8px 25px rgba(0,0,0,0.15), 0 4px 8px rgba(0,0,0,0.08);
      border-color: #2E7D32;
    }
    .options li::before { content: ''; }
    .options li.correct {
      background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
      border-color: #4CAF50;
      color: #1B5E20;
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
    }
    
    .options li.correct::before {
      content: 'âœ…';
    }
    .options li.incorrect {
      background: linear-gradient(135deg, #FDECEA 0%, #FFCDD2 100%);
      border-color: #F44336;
      color: #C62828;
      transform: scale(0.98);
    }
    
    .options li.incorrect::before {
      content: 'âŒ';
    }

    #score {
      margin-top: 1rem;
      font-weight: 700;
      color: #1d3b2f;
      text-align: center;
      background: linear-gradient(90deg, #fff, #f9f9f9);
      border-radius: 10px;
      padding: 8px 12px;
      border: 2px solid #e8e8e8;
      display: inline-block;
      min-width: 220px;
      font-size: 1em;
    }

    #certificate {
      display: none;
      text-align: center;
      padding: 2rem 1.2rem 3rem;
    }
    #certificate .card {
      margin: 0 auto;
      max-width: 1000px;
      background: #ffffff;
      border-radius: 12px;
      padding: 2rem 2.5rem;
      border: 1px solid #D8DFE3;
      box-shadow: 0 12px 30px rgba(0,0,0,0.08);
      position: relative;
    }
    #certificate .ribbon { display:none; }
    #certificate h2 {
      color: var(--secondary);
      font-size: 34px;
      font-family: 'Merriweather', serif;
      letter-spacing: .5px;
      margin-bottom: 0.5rem;
    }
    #certificate button {
      margin-top: 1rem;
      background: var(--primary);
      color: #fff;
      border: none;
      padding: 0.65rem 1.25rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      box-shadow: 0 8px 16px rgba(0,0,0,0.12);
    }

    /* Certificate footer */
    .cert-footer {
      display: flex;
      justify-content: space-between;
      gap: 24px;
      margin-top: 28px;
      padding-top: 16px;
      border-top: 1px solid #E0E6EA;
    }
    .sig-block {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }
    .sig-text {
      color: var(--secondary);
      font-weight: 600;
      margin-bottom: 10px;
    }
    .sig-line {
      height: 1px;
      background: #B0BEC5;
      margin-top: 18px;
    }
    .sig-label {
      color: var(--ink-soft);
      font-size: 0.85em;
      margin-top: 6px;
    }

    .nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      padding: 0.75rem;
      text-align: center;
      z-index: 10;
      box-shadow: 0 -6px 16px rgba(0,0,0,0.06);
    }
    .nav button {
      background: #fff;
      color: #2E4A3B;
      border: 3px solid #00000014;
      padding: 0.6rem 1.1rem;
      margin: 0 0.4rem;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 900;
      font-family: 'Cairo', sans-serif;
      font-size: 1em;
      box-shadow: 0 3px 0 #00000010, 0 10px 16px rgba(0,0,0,0.08);
      transition: transform .08s ease;
    }
    .nav button:hover { transform: translateY(-1px); }
    .nav button:active { transform: translateY(2px); }

    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      border: 1px solid #E0E6EA;
      border-radius: 12px;
      padding: 1rem;
      max-width: 460px;
      width: 90%;
      box-shadow: 0 12px 24px rgba(0,0,0,0.12);
      z-index: 200;
      text-align: center;
      background-image: none;
    }
    .modal h3 { margin-top: 0; color: var(--secondary); font-family: 'Cairo', sans-serif; font-size: 28px; }
    .modal button {
      margin-top: 0.75rem;
      background: var(--primary);
      color: #fff;
      border: none;
      padding: 0.55rem 1.1rem;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
    }

    /* Certificate/Print adjustments */
    body.certificate-mode header img { height: 28px; }
    body.certificate-mode .nav { display: none; }
    @media print {
      @page { size: A4 landscape; margin: 10mm; }
      body { background: #fff !important; }
      header { box-shadow: none; }
      header img { height: 24px !important; }
      .nav, #score { display: none !important; }
      #certificate { display: block !important; }
      #quizBox, .modal { display: none !important; }
      #certificate .card { max-width: 100%; box-shadow: none; border-width: 6px; }
    }

    /* Educational Content Box */
    .edu-content {
      background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
      border: 2px solid #2196F3;
      border-radius: 16px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      box-shadow: 0 6px 20px rgba(33, 150, 243, 0.15);
      position: relative;
      overflow: hidden;
    }
    
    .edu-content::before {
      content: 'ğŸ“';
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 2em;
      opacity: 0.3;
    }
    
    .edu-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
      font-family: 'Amiri', serif;
      font-size: 1.4em;
      font-weight: 700;
      color: #1565C0;
    }
    
    .edu-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 1rem;
    }
    
    .edu-tab {
      padding: 8px 16px;
      background: rgba(255,255,255,0.7);
      border: 2px solid #2196F3;
      border-radius: 20px;
      cursor: pointer;
      font-family: 'Cairo', sans-serif;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 0.9em;
    }
    
    .edu-tab.active {
      background: #2196F3;
      color: white;
      transform: scale(1.05);
    }
    
    .edu-tab:hover {
      background: #1976D2;
      color: white;
      transform: translateY(-2px);
    }
    
    .edu-content-area {
      min-height: 200px;
      background: rgba(255,255,255,0.8);
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid rgba(33, 150, 243, 0.2);
    }
    
    .video-placeholder {
      background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
      border-radius: 12px;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-family: 'Amiri', serif;
      font-size: 1.2em;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .video-placeholder::before {
      content: 'â–¶ï¸';
      font-size: 3em;
      margin-left: 10px;
    }
    
    .video-placeholder:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    .infographic-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .info-card {
      background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
      border: 2px solid #FF9800;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .info-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(255, 152, 0, 0.3);
    }
    
    .info-icon {
      font-size: 2.5em;
      margin-bottom: 0.5rem;
    }
    
    .info-title {
      font-family: 'Amiri', serif;
      font-weight: 700;
      color: #E65100;
      margin-bottom: 0.5rem;
    }
    
    .info-desc {
      font-family: 'Cairo', sans-serif;
      font-size: 0.9em;
      color: #BF360C;
      line-height: 1.4;
    }
    
    /* Auto-advance feature */
    .auto-advance {
      background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
      border: 2px solid #4CAF50;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
      text-align: center;
      font-family: 'Cairo', sans-serif;
      font-weight: 600;
      color: #1B5E20;
    }
    
    .countdown {
      font-size: 1.5em;
      font-weight: 700;
      color: #2E7D32;
      margin: 0.5rem 0;
    }
    
    /* Progress bar */
    .progress-container {
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      height: 8px;
      margin: 1rem 0;
      overflow: hidden;
    }
    
    .progress-bar {
      background: linear-gradient(90deg, #2E7D32, #4CAF50, #66BB6A);
      height: 100%;
      width: 0%;
      transition: width 0.5s ease;
      border-radius: 10px;
    }
    
    /* Animations */
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .slide-in {
      animation: slideInUp 0.6s ease-out;
    }
    
    .pulse {
      animation: pulse 2s infinite;
    }
  </style>
</head>
<body>
<header>
  <img src="logo-left.png" alt="Left Logo" />
  <h1>ğŸš› Ù…ØºØ§Ù…Ø±Ø© Ø³Ù„Ø§Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¡ â€“ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ù‚Ù„</h1>
  <img src="logo-right.png" alt="Right Logo" />
  </header>

<div class="container" id="quizBox">
  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  
  <!-- Educational Content Box -->
  <div class="edu-content" id="eduContent">
    <div class="edu-header">
      <span>ğŸ“</span>
      <span>Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ</span>
    </div>
    <div class="edu-tabs">
      <div class="edu-tab active" onclick="switchEduTab('video')">ğŸ“¹ ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ù„ÙŠÙ…ÙŠ</div>
      <div class="edu-tab" onclick="switchEduTab('info')">ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©</div>
      <div class="edu-tab" onclick="switchEduTab('tips')">ğŸ’¡ Ù†ØµØ§Ø¦Ø­</div>
    </div>
    <div class="edu-content-area" id="eduContentArea">
      <!-- Content will be loaded dynamically -->
    </div>
  </div>
  
  <div class="question" id="question"></div>
  <ul class="options" id="options"></ul>
  
  <!-- Auto-advance notification -->
  <div class="auto-advance" id="autoAdvance" style="display: none;">
    <div>â° Ø³ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø®Ù„Ø§Ù„:</div>
    <div class="countdown" id="countdown">5</div>
  </div>
  
  <div style="text-align:center"><div id="score">ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: 0 / 0</div></div>
  </div>

<div id="certificate">
  <div class="card">
    <div class="ribbon">ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ğŸ‰</div>
    <h2>ğŸ“ Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙˆØ±Ø©</h2>
    <p>Ù‡Ø°Ù‡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ØªØ¤ÙƒØ¯ Ø£Ù† <strong id="userName">Ù…Ø­Ù…Ø¯</strong> Ù‚Ø¯ Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­</p>
    <p><em>Ø¯ÙˆØ±Ø© Ø³Ù„Ø§Ù…Ø© Ù†Ù‚Ù„ Ø§Ù„ØºØ°Ø§Ø¡</em></p>
    <p>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: <strong id="finalScore">0/0</strong></p>
    <div id="categoryStats" style="margin-top:12px"></div>
    <div id="certMeta" style="margin-top:8px; color:#556; font-size:.9rem; display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap">
      <canvas id="certQr" width="96" height="96" style="border:1px solid #E0E6EA; border-radius:6px; background:#fff"></canvas>
    </div>
    <div class="cert-footer">
      <div class="sig-block">
        <div class="sig-text">Ø¨Ù„Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø´Ø§Ø±Ù‚Ø© â€“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ø³Ù„Ø§Ù…Ø©</div>
        <div class="sig-line"></div>
        <div class="sig-label">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</div>
      </div>
      <div class="sig-block" style="max-width: 260px; align-items:flex-end;">
        <div class="sig-text" id="certDate">â€”</div>
        <div class="sig-line" style="width:100%"></div>
        <div class="sig-label">Ø§Ù„ØªØ§Ø±ÙŠØ®</div>
      </div>
    </div>
    <div style="margin-top:12px; display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap">
      <button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</button>
      <button id="resetBtn" type="button" style="background:#fff;color:#2F3A3B;border:1px solid #CBD5E1">â†º Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙƒÙˆÙŠØ²</button>
    </div>
  </div>
  </div>

<div class="nav">
  <button onclick="prevQuestion()">â¬…ï¸ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
  <button onclick="nextQuestion()">Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
  </div>

<div class="modal" id="feedbackModal">
  <h3>ğŸ’¡ Ù†ØµÙŠØ­Ø©</h3>
  <p id="modalContent"></p>
  <button onclick="closeModal()">Ù…ØªØ§Ø¨Ø¹Ø©</button>
  </div>
<script>
  let quizzes = [];
  let current = 0;
  let score = 0;
  let answered = {};
  let answeredCorrect = {};
  let autoAdvanceTimer = null;
  let currentEduTab = 'video';

  function seedFallbackQuizzes() {
    return [
      {
        id: 1,
        question: 'Ù…Ø§ Ù‡ÙŠ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ù†Ù‚Ù„ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ„ÙØŸ',
        options: ['0-5Â°C', '10-15Â°C', '20-25Â°C', 'Ø£ÙŠ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø©'],
        answer: 0,
        explanation: 'ÙŠØ¬Ø¨ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ø¨Ø±Ø¯Ø© Ø¹Ø§Ø¯Ø© Ø¹Ù†Ø¯ 0-5Â°C Ù„Ù…Ù†Ø¹ Ù†Ù…Ùˆ Ø§Ù„Ø¨ÙƒØªÙŠØ±ÙŠØ§.'
      },
      {
        id: 2,
        question: 'Ø£ÙŠ Ù…Ù…Ø§Ø±Ø³Ø© ØªÙ‚Ù„Ù„ Ù…Ù† Ø§Ù„ØªÙ„ÙˆØ« Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ù‚Ù„ØŸ',
        options: ['Ø®Ù„Ø· Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù†ÙŠØ¦Ø© ÙˆØ§Ù„Ù…Ø·Ø¨ÙˆØ®Ø©', 'Ø­Ø§ÙˆÙŠØ§Øª Ù…Ù†ÙØµÙ„Ø© ÙˆÙ…Ø®ØªÙˆÙ…Ø©', 'Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ù„ØªÙˆØ³ÙŠÙ…', 'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ø£Ø¯ÙˆØ§Øª'],
        answer: 1,
        explanation: 'Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø© ÙˆØ§Ù„Ù…Ø®ØªÙˆÙ…Ø© ÙˆØ§Ù„ØªÙˆØ³ÙŠÙ… ÙŠØ³Ø§Ø¹Ø¯Ø§Ù† ÙÙŠ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙ„ÙˆØ« Ø§Ù„Ù…ØªØ¨Ø§Ø¯Ù„.'
      },
      {
        id: 3,
        question: 'Ù…Ø§Ø°Ø§ ÙŠØ¬Ø¨ ÙØ¹Ù„Ù‡ Ù‚Ø¨Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ø¹Ø§Ù…ØŸ',
        options: ['ØªØ¬Ø§Ù‡Ù„ Ù†Ø¸Ø§ÙØ© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'ØªØ¹Ù‚ÙŠÙ… Ø£Ø³Ø·Ø­ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ¨Ø±ÙŠØ¯', 'ØªØ®Ø·ÙŠ Ø§Ù„ÙØ­ÙˆØµØ§Øª'],
        answer: 1,
        explanation: 'Ø§Ù„ØªØ¹Ù‚ÙŠÙ… ÙŠÙ‚Ù„Ù„ Ù…Ù† Ù…Ø®Ø§Ø·Ø± Ø§Ù„ØªÙ„ÙˆØ«Ø› ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„ØªØ¨Ø±ÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„.'
      }
    ];
  }

  fetch('quizzes.json')
    .then(res => res.ok ? res.json() : Promise.reject())
    .then(data => {
      quizzes = data.quizzes || seedFallbackQuizzes();
      showQuestion();
      updateScore();
    })
    .catch(() => {
      quizzes = seedFallbackQuizzes();
      showQuestion();
      updateScore();
    });

  function showQuestion() {
    const q = quizzes[current];
    if (!q) return;
    
    // Update progress bar
    updateProgressBar();
    
    // Load educational content
    loadEducationalContent(q);
    
    const manualType = normalizeType(q.category);
    const type = manualType || detectType(q.question);
    const icon = '';
    const qEl = document.getElementById('question');
    const badge = type ? `<span class="qbadge ${type}">${type}</span>` : '';
    qEl.innerHTML = `${badge} Q${q.id}: ${q.question}`;
    qEl.classList.add('slide-in');
    
    const box = document.getElementById('quizBox');
    box.classList.remove('qtheme-cool','qtheme-clean','qtheme-transport','qtheme-pack','qtheme-label');
    if (type) box.classList.add(`qtheme-${type}`);
    
    const optionsList = document.getElementById('options');
    optionsList.innerHTML = '';

    q.options.forEach((opt, i) => {
      const li = document.createElement('li');
      li.textContent = opt;
      li.onclick = () => {
        if (answered[current]) return;
        answered[current] = true;
        
        // Clear auto-advance timer
        if (autoAdvanceTimer) {
          clearTimeout(autoAdvanceTimer);
          autoAdvanceTimer = null;
        }
        document.getElementById('autoAdvance').style.display = 'none';
        
        if (i === q.answer) {
          li.classList.add('correct');
          score++;
          answeredCorrect[current] = true;
        } else {
          li.classList.add('incorrect');
          if (optionsList.children[q.answer]) {
            optionsList.children[q.answer].classList.add('correct');
          }
          answeredCorrect[current] = false;
        }
        updateScore();
        
        // Auto-advance after 3 seconds
        startAutoAdvance();
      };
      optionsList.appendChild(li);
    });
  }

  function detectType(text) {
    const t = (text || '').toLowerCase();
    if (/(temp|cold|chill|cool|Â°|c|cold chain|freeze|refriger)/.test(t)) return 'cool';
    if (/(sanitize|clean|hygiene|wash|disinfect|cleanliness)/.test(t)) return 'clean';
    if (/(transport|truck|deliver|vehicle|load|unload|route)/.test(t)) return 'transport';
    if (/(pack|seal|container|package|wrap|box)/.test(t)) return 'pack';
    if (/(label|expiry|date|trace|tag)/.test(t)) return 'label';
    return '';
  }

  function detectIcon(text) {
    const t = (text || '').toLowerCase();
    if (/(temp|cold|chill|cool|Â°|c|cold chain|freeze|refriger)/.test(t)) return 'ğŸ§Š';
    if (/(sanitize|clean|hygiene|wash|disinfect|sanitize|cleanliness)/.test(t)) return 'ğŸ§¼';
    if (/(transport|truck|deliver|vehicle|load|unload|route)/.test(t)) return 'ğŸšš';
    if (/(pack|seal|container|package|wrap|box)/.test(t)) return 'ğŸ¥¡';
    if (/(label|expiry|date|trace|tag)/.test(t)) return 'ğŸ·ï¸';
    return 'ğŸ½ï¸';
  }

  function normalizeType(category) {
    if (!category) return '';
    const t = String(category).toLowerCase().trim();
    if (/^(temp|cold|cool|chill|freeze|refriger|temperature|cold\s*chain)$/.test(t)) return 'cool';
    if (/^(clean|cleaning|hygiene|wash|sanitize|sanitization|disinfect)$/.test(t)) return 'clean';
    if (/^(transport|delivery|vehicle|logistics|route|loading)$/.test(t)) return 'transport';
    if (/^(pack|packaging|seal|container|boxing|wrapping)$/.test(t)) return 'pack';
    if (/^(label|labelling|labeling|expiry|expiration|trace|traceability|tag)$/.test(t)) return 'label';
    return '';
  }

  function iconForType(type) {
    switch (type) {
      case 'cool': return 'ğŸ§Š';
      case 'clean': return 'ğŸ§¼';
      case 'transport': return 'ğŸšš';
      case 'pack': return 'ğŸ¥¡';
      case 'label': return 'ğŸ·ï¸';
      default: return 'ğŸ½ï¸';
    }
  }

  function nextQuestion() {
    if (current < quizzes.length - 1) {
      current++;
      showQuestion();
    } else {
      showCertificate();
    }
  }

  function closeModal() {
    document.getElementById('feedbackModal').style.display = 'none';
    nextQuestion();
  }

  function prevQuestion() {
    if (current > 0) {
      current--;
      showQuestion();
    }
  }

  function updateScore() {
    const el = document.getElementById('score');
    if (el) el.textContent = `ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score} / ${quizzes.length}`;
  }
  
  function updateProgressBar() {
    const progress = ((current + 1) / quizzes.length) * 100;
    const progressBar = document.getElementById('progressBar');
    if (progressBar) {
      progressBar.style.width = progress + '%';
    }
  }
  
  function loadEducationalContent(question) {
    const type = normalizeType(question.category) || detectType(question.question);
    const contentArea = document.getElementById('eduContentArea');
    
    if (currentEduTab === 'video') {
      contentArea.innerHTML = `
        <div class="video-placeholder" onclick="playVideo('${type}')">
          <div>
            <div>Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</div>
            <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
              ${getVideoTitle(type)}
            </div>
          </div>
        </div>
      `;
    } else if (currentEduTab === 'info') {
      contentArea.innerHTML = `
        <div class="infographic-content">
          ${getInfographicContent(type)}
        </div>
      `;
    } else if (currentEduTab === 'tips') {
      contentArea.innerHTML = `
        <div style="font-family: 'Cairo', sans-serif; line-height: 1.6;">
          <h4 style="color: #1565C0; margin-bottom: 1rem;">ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù…Ù‡Ù…Ø©:</h4>
          ${getTipsContent(type)}
        </div>
      `;
    }
  }
  
  function switchEduTab(tab) {
    currentEduTab = tab;
    
    // Update tab styles
    document.querySelectorAll('.edu-tab').forEach(t => t.classList.remove('active'));
    event.target.classList.add('active');
    
    // Reload content
    const q = quizzes[current];
    if (q) loadEducationalContent(q);
  }
  
  function getVideoTitle(type) {
    const titles = {
      'cool': 'Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©',
      'clean': 'Ø§Ù„Ù†Ø¸Ø§ÙØ© ÙˆØ§Ù„ØªØ¹Ù‚ÙŠÙ…',
      'transport': 'Ù†Ù‚Ù„ Ø§Ù„ØºØ°Ø§Ø¡ Ø§Ù„Ø¢Ù…Ù†',
      'pack': 'Ø§Ù„ØªØ¹Ø¨Ø¦Ø© ÙˆØ§Ù„ØªØºÙ„ÙŠÙ',
      'label': 'Ø§Ù„ØªÙˆØ³ÙŠÙ… ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚'
    };
    return titles[type] || 'Ø³Ù„Ø§Ù…Ø© Ø§Ù„ØºØ°Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù…Ø©';
  }
  
  function getInfographicContent(type) {
    const content = {
      'cool': `
        <div class="info-card">
          <div class="info-icon">ğŸ§Š</div>
          <div class="info-title">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</div>
          <div class="info-desc">0-5Â°C Ù„Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ø¨Ø±Ø¯Ø©<br>-18Â°C Ù„Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù…Ø¬Ù…Ø¯Ø©</div>
        </div>
        <div class="info-card">
          <div class="info-icon">ğŸŒ¡ï¸</div>
          <div class="info-title">Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</div>
          <div class="info-desc">ÙØ­Øµ Ø¯ÙˆØ±ÙŠ ÙƒÙ„ Ø³Ø§Ø¹ØªÙŠÙ†<br>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª</div>
        </div>
        <div class="info-card">
          <div class="info-icon">â„ï¸</div>
          <div class="info-title">Ø§Ù„ØªØ¨Ø±ÙŠØ¯</div>
          <div class="info-desc">ÙˆØ­Ø¯Ø§Øª ØªØ¨Ø±ÙŠØ¯ Ù…Ù†Ø§Ø³Ø¨Ø©<br>Ø¹Ø²Ù„ Ø¬ÙŠØ¯ Ù„Ù„Ø­Ø±Ø§Ø±Ø©</div>
        </div>
      `,
      'clean': `
        <div class="info-card">
          <div class="info-icon">ğŸ§¼</div>
          <div class="info-title">Ø§Ù„ØªÙ†Ø¸ÙŠÙ</div>
          <div class="info-desc">ØªÙ†Ø¸ÙŠÙ ÙŠÙˆÙ…ÙŠ Ø´Ø§Ù…Ù„<br>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆØ§Ø¯ Ù…Ø¹Ù‚Ù…Ø©</div>
        </div>
        <div class="info-card">
          <div class="info-icon">ğŸ¦ </div>
          <div class="info-title">Ù…Ù†Ø¹ Ø§Ù„ØªÙ„ÙˆØ«</div>
          <div class="info-desc">ÙØµÙ„ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ù†ÙŠØ¦Ø©<br>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¯ÙˆØ§Øª Ù…Ù†ÙØµÙ„Ø©</div>
        </div>
        <div class="info-card">
          <div class="info-icon">ğŸ‘¨â€ğŸ³</div>
          <div class="info-title">Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</div>
          <div class="info-desc">ØºØ³Ù„ Ø§Ù„ÙŠØ¯ÙŠÙ†<br>Ø§Ø±ØªØ¯Ø§Ø¡ Ø§Ù„Ù‚ÙØ§Ø²Ø§Øª</div>
        </div>
      `,
      'transport': `
        <div class="info-card">
          <div class="info-icon">ğŸšš</div>
          <div class="info-title">Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</div>
          <div class="info-desc">ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ©<br>ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ù…Ù„</div>
        </div>
        <div class="info-card">
          <div class="info-icon">ğŸ“¦</div>
          <div class="info-title">Ø§Ù„ØªØ­Ù…ÙŠÙ„</div>
          <div class="info-desc">ØªØ±ØªÙŠØ¨ ØµØ­ÙŠØ­<br>Ù…Ù†Ø¹ Ø§Ù„ØªÙ„Ù</div>
        </div>
        <div class="info-card">
          <div class="info-icon">â°</div>
          <div class="info-title">Ø§Ù„ÙˆÙ‚Øª</div>
          <div class="info-desc">ØªØ³Ù„ÙŠÙ… Ø³Ø±ÙŠØ¹<br>ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ£Ø®ÙŠØ±</div>
        </div>
      `
    };
    return content[type] || content['transport'];
  }
  
  function getTipsContent(type) {
    const tips = {
      'cool': `
        <ul style="list-style: none; padding: 0;">
          <li>â„ï¸ ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ØªØ¨Ø±ÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„</li>
          <li>ğŸŒ¡ï¸ Ø±Ø§Ù‚Ø¨ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© ÙƒÙ„ Ø³Ø§Ø¹ØªÙŠÙ†</li>
          <li>ğŸ“ Ø³Ø¬Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø¬Ù„</li>
          <li>ğŸš¨ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø·Ù„ØŒ Ø§Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø¶Ø§Ø¦Ø¹ ÙÙˆØ±Ø§Ù‹</li>
        </ul>
      `,
      'clean': `
        <ul style="list-style: none; padding: 0;">
          <li>ğŸ§¼ Ù†Ø¸Ù Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯ ÙƒÙ„ Ø±Ø­Ù„Ø©</li>
          <li>ğŸ¦  Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ§Ø¯ Ù…Ø¹Ù‚Ù…Ø© Ù…Ø¹ØªÙ…Ø¯Ø©</li>
          <li>ğŸ‘¥ Ø¯Ø±Ø¨ Ø§Ù„Ø¹Ù…Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§ÙØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</li>
          <li>ğŸ“‹ Ø§Ø­ØªÙØ¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ</li>
        </ul>
      `,
      'transport': `
        <ul style="list-style: none; padding: 0;">
          <li>ğŸš› ØªØ£ÙƒØ¯ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</li>
          <li>ğŸ“¦ Ø±ØªØ¨ Ø§Ù„Ø¨Ø¶Ø§Ø¦Ø¹ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</li>
          <li>ğŸ›£ï¸ Ø§Ø®ØªØ± Ø£Ù‚ØµØ± Ø·Ø±ÙŠÙ‚ Ø¢Ù…Ù†</li>
          <li>â° ØªØ¬Ù†Ø¨ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ©</li>
        </ul>
      `
    };
    return tips[type] || tips['transport'];
  }
  
  function playVideo(type) {
    alert(`Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ù„ÙŠÙ…ÙŠ Ø¹Ù†: ${getVideoTitle(type)}\n\n(Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ - ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡ Ø¨ÙÙŠØ¯ÙŠÙˆ Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù† YouTube Ø£Ùˆ Ø£ÙŠ Ù…Ù†ØµØ© Ø£Ø®Ø±Ù‰)`);
  }
  
  function startAutoAdvance() {
    let countdown = 3;
    const countdownEl = document.getElementById('countdown');
    const autoAdvanceEl = document.getElementById('autoAdvance');
    
    autoAdvanceEl.style.display = 'block';
    
    const timer = setInterval(() => {
      countdownEl.textContent = countdown;
      countdown--;
      
      if (countdown < 0) {
        clearInterval(timer);
        autoAdvanceEl.style.display = 'none';
        nextQuestion();
      }
    }, 1000);
    
    autoAdvanceTimer = timer;
  }

  function showCertificate() {
    document.getElementById('quizBox').style.display = 'none';
    document.getElementById('finalScore').textContent = `${score} / ${quizzes.length}`;
    document.getElementById('certificate').style.display = 'block';
    document.body.classList.add('certificate-mode');
    renderCategoryStats();
    const d = new Date();
    const dateStr = d.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
    const dateEl = document.getElementById('certDate');
    if (dateEl) dateEl.textContent = dateStr;
    const certId = generateCertificateId();
    const meta = document.getElementById('certMeta');
    const verifyUrl = `${window.location.origin}/verify?cert=${encodeURIComponent(certId)}`;
    if (meta) {
      // prepend text label and verify link before QR canvas
      const label = document.createElement('span');
      label.textContent = `Ø±Ù‚Ù… Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©: ${certId}`;
      const link = document.createElement('a');
      link.href = verifyUrl;
      link.target = '_blank';
      link.rel = 'noopener noreferrer';
      link.textContent = 'Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª';
      link.style.marginLeft = '8px';
      meta.prepend(label);
      meta.prepend(link);
    }
    renderQr(verifyUrl);
    
  }

  function burstConfetti(count = 50) {
    const colors = [
      'var(--clown-red)', 'var(--clown-yellow)', 'var(--clown-green)', 'var(--clown-blue)', 'var(--clown-purple)'
    ];
    for (let i = 0; i < count; i++) {
      const piece = document.createElement('div');
      piece.className = 'confetti';
      piece.style.left = Math.random() * 100 + 'vw';
      piece.style.background = colors[Math.floor(Math.random() * colors.length)];
      piece.style.transform = `translateY(-20px) rotate(${Math.random()*360}deg)`;
      const duration = 2.4 + Math.random() * 1.6;
      piece.style.animationDuration = duration + 's';
      piece.style.opacity = (0.7 + Math.random()*0.3).toFixed(2);
      piece.style.width = (6 + Math.random()*8) + 'px';
      piece.style.height = (8 + Math.random()*12) + 'px';
      document.body.appendChild(piece);
      setTimeout(() => piece.remove(), duration * 1000);
    }
  }

  function renderCategoryStats() {
    const counters = { cool: { c: 0, t: 0, icon: 'ğŸ§Š', label: 'Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø¨Ø§Ø±Ø¯Ø©' }, clean: { c: 0, t: 0, icon: 'ğŸ§¼', label: 'Ø§Ù„Ù†Ø¸Ø§ÙØ©' }, transport: { c: 0, t: 0, icon: 'ğŸšš', label: 'Ø§Ù„Ù†Ù‚Ù„' }, pack: { c: 0, t: 0, icon: 'ğŸ¥¡', label: 'Ø§Ù„ØªØ¹Ø¨Ø¦Ø©' }, label: { c: 0, t: 0, icon: 'ğŸ·ï¸', label: 'Ø§Ù„ØªÙˆØ³ÙŠÙ…' } };
    quizzes.forEach((q, idx) => {
      const manual = normalizeType(q.category);
      const type = manual || detectType(q.question);
      const key = counters[type] ? type : null;
      if (!key) return;
      counters[key].t += 1;
      if (answeredCorrect[idx] === true) counters[key].c += 1;
    });
    const container = document.getElementById('categoryStats');
    const order = ['cool','clean','transport','pack','label'];
    const parts = order
      .filter(k => counters[k].t > 0)
      .map(k => {
        const { c, t, icon, label } = counters[k];
        return `<span style="display:inline-flex;align-items:center;gap:6px;margin:4px 8px;padding:6px 10px;border-radius:999px;background:#ffffffcc;border:1px solid #00000012">${icon} <strong>${label}</strong> <span style="opacity:.8">${c}/${t}</span></span>`;
      });
    container.innerHTML = parts.join('');
  }

  function generateCertificateId() {
    const rnd = Math.random().toString(36).slice(2, 8).toUpperCase();
    const ts = Date.now().toString(36).toUpperCase().slice(-6);
    return `${ts}-${rnd}`;
  }

  function renderQr(text) {
    try {
      const canvas = document.getElementById('certQr');
      if (!canvas || typeof QRious === 'undefined') return;
      new QRious({ element: canvas, value: text, size: 96, level: 'H', background: 'white', foreground: '#222' });
    } catch (_) {}
  }

  // Reset quiz flow
  document.addEventListener('click', (e) => {
    if (e.target && e.target.id === 'resetBtn') {
      resetQuiz();
    }
  });

  function resetQuiz() {
    current = 0;
    score = 0;
    answered = {};
    answeredCorrect = {};
    document.getElementById('certificate').style.display = 'none';
    document.getElementById('quizBox').style.display = 'block';
    document.body.classList.remove('certificate-mode');
    showQuestion();
    updateScore();
  }

  // Basic RTL auto-detect (Arabic locales)
  (function applyRTL() {
    try {
      const lang = (navigator.language || navigator.userLanguage || 'en').toLowerCase();
      if (lang.startsWith('ar')) {
        document.documentElement.setAttribute('dir', 'rtl');
      }
    } catch (_) {}
  })();
</script>
</body>
</html>


